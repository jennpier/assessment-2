{% extends 'base.html' %}
{% block title %}Booking History{% endblock %}
{% block content %}

<div class="container py-5">
  <h1 class="text-center mb-5 fw-bold">My Bookings</h1>

  {% if bookings %}
    <div class="row g-4">
      {% for booking in bookings %}
        {% set event = booking.event %}
        <div class="col-md-6 col-lg-4">
          <div class="card h-100 shadow-sm border-0">
            
            <!-- Event Image -->
            <img src="{{ url_for('static', filename='images/' + (event.image or 'default.jpg')) }}"
                 class="card-img-top rounded-top"
                 style="height: 200px; object-fit: cover;"
                 alt="{{ event.title }}">
            
            <div class="card-body">
              <h5 class="card-title fw-bold">{{ event.title }}</h5>
              <p class="text-muted mb-1"><i class="bi bi-geo-alt"></i> {{ event.venue.name }}</p>
              <p class="text-muted mb-1"><i class="bi bi-calendar-event"></i> {{ event.date_time.strftime('%A, %d %B %Y %I:%M %p') }}</p>
              <p class="text-muted mb-1"><i class="bi bi-clock-history"></i> {{ event.duration_minutes }} mins</p>
              <hr>

              <p><strong>Booking ID:</strong> {{ booking.id }}</p>
              <p><strong>Booked On:</strong> {{ booking.booking_date.strftime('%d %B %Y @ %H:%M') }}</p>
              <p><strong>Tickets:</strong> {{ booking.no_of_tickets }}</p>
              <p><strong>Total Price:</strong> ${{ booking.total_price }}</p>
              <p><strong>Event Status:</strong> 
                <span class="badge 
                  {% if event.status == 'Open' %}bg-success
                  {% elif event.status == 'Sold Out' %}bg-danger
                  {% elif event.status == 'Cancelled' %}bg-secondary
                  {% else %}bg-warning text-dark{% endif %}">
                  {{ event.status }}
                </span>
              </p>
            </div>

            <div class="card-footer bg-transparent border-top-0">
              <a href="{{ url_for('events.event_detail', event_id=event.id) }}" class="btn btn-outline-primary w-100">
                View Event Details
              </a>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-info text-center mt-5">
      <i class="bi bi-ticket-perforated"></i> You havenâ€™t booked any events yet.
    </div>
  {% endif %}
</div>

{% endblock %}
